# TEMPLATE 4B/5A -- Busca métrica seguindo o caminho Empresa -> Valor -> Intermediário -> Negociação
SELECT ?S1 ?ANS WHERE {
    ?S1 P7 ?label .
    FILTER(REGEX(STR(?label), "#ENTIDADE_NOME#", "i"))
    
    ?S1 P1 ?SO1 .
    ?SO1 P1 ?intermediario .  # O caminho extra que estava faltando
    ?intermediario P3 ?SO2 .
    ?SO2 P5 ?S2 .
    ?S2 P6 "#DATA#"^^xsd:date .
    ?SO2 #VALOR_DESEJADO# ?ANS .
}